<script>
(function(){
  const banner = document.getElementById('cookie-banner');
  const btn = document.getElementById('accept-cookies');

  // Funciones para manejar cookies
  function setCookie(name, value, days) {
    const d = new Date();
    d.setTime(d.getTime() + (days*24*60*60*1000));
    const expires = "expires="+ d.toUTCString();
    document.cookie = name + "=" + value + ";" + expires + ";path=/";
  }

  function getCookie(name) {
    const cname = name + "=";
    const decodedCookie = decodeURIComponent(document.cookie);
    const ca = decodedCookie.split(';');
    for(let i = 0; i < ca.length; i++) {
      let c = ca[i].trim();
      if (c.indexOf(cname) === 0) return c.substring(cname.length, c.length);
    }
    return "";
  }

  // Mostrar banner solo si no hay cookie de aceptación
  if(getCookie('cookies_accepted') === 'true'){
    banner.style.display = 'none';
  } else {
    banner.style.display = 'flex';
  }

  // Al hacer clic en aceptar
  btn.addEventListener('click', function(){
    setCookie('cookies_accepted', 'true', 365); // 365 días
    banner.style.display = 'none';

    // Activar Google Analytics tras consentimiento
    if(typeof gtag === 'function'){
      gtag('consent', 'update', {
        'analytics_storage': 'granted'
      });
    }
  });

  // Ajuste responsivo
  function adjustBanner(){
    if(window.innerWidth < 500){
      banner.style.flexDirection = 'column';
      banner.style.textAlign = 'center';
    } else {
      banner.style.flexDirection = 'row';
      banner.style.textAlign = 'center';
    }
  }

  window.addEventListener('resize', adjustBanner);
  adjustBanner();
})();
</script>
